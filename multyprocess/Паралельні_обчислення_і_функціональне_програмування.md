
### **1. –í—Å—Ç—É–ø **

–£ —Å—É—á–∞—Å–Ω–æ–º—É –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—ñ –∑—Ä–æ—Å—Ç–∞—î –ø–æ—Ç—Ä–µ–±–∞ –≤ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—ñ –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö. –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π, –∫–æ–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –æ–±—Ä–æ–±–ª—è—î –∫–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç –ø–æ —á–µ—Ä–∑—ñ, —Å—Ç–∞—î —Å–µ—Ä–π–æ–∑–Ω–∏–º –æ–±–º–µ–∂–µ–Ω–Ω—è–º –¥–ª—è –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∏—Ö —Å–∏—Å—Ç–µ–º. –û–¥–∏–Ω —ñ–∑ –ø—ñ–¥—Ö–æ–¥—ñ–≤ –¥–æ –≤–∏—Ä—ñ—à–µ–Ω–Ω—è —Ü—ñ—î—ó –ø—Ä–æ–±–ª–µ–º–∏ ‚Äî **–ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è**, —â–æ –¥–æ–∑–≤–æ–ª—è—é—Ç—å —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ –∫—ñ–ª—å–∫–∞ —á–∞—Å—Ç–∏–Ω —ñ –æ–±—Ä–æ–±–ª—è—Ç–∏ —ó—Ö –æ–¥–Ω–æ—á–∞—Å–Ω–æ. –¶–µ –æ—Å–æ–±–ª–∏–≤–æ –≤–∞–∂–ª–∏–≤–æ –¥–ª—è –∑–∞–¥–∞—á, —â–æ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è –Ω–∞ –±–∞–≥–∞—Ç–æ—è–¥–µ—Ä–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞—Ö –∞–±–æ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö.

–†–æ–∑—Ä–æ–±–∫–∞ –ø—Ä–æ–≥—Ä–∞–º, —â–æ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å –ø–∞—Ä–∞–ª–µ–ª—å–Ω–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ –ø–æ–≤‚Äô—è–∑–∞–Ω–∞ –∑ —Ç—Ä—É–¥–Ω–æ—â–∞–º–∏: –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –≤—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—é –º—ñ–∂ –ø–æ—Ç–æ–∫–∞–º–∏, –∫–æ–Ω—Ç—Ä–æ–ª—å —Å—Ç–∞–Ω—É –∑–º—ñ–Ω–Ω–∏—Ö —ñ –æ–±—Ä–æ–±–∫—É –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ –¥–æ—Å—Ç—É–ø—É –¥–æ –ø–∞–º‚Äô—è—Ç—ñ. –û–¥–Ω–∏–º —ñ–∑ —Ä—ñ—à–µ–Ω—å —Ü–∏—Ö –ø—Ä–æ–±–ª–µ–º —î **—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è**, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–æ –º—ñ–Ω—ñ–º—ñ–∑—É—î –ø–æ–±—ñ—á–Ω—ñ –µ—Ñ–µ–∫—Ç–∏ —Ç–∞ –∑–º—ñ–Ω—é–≤–∞–Ω–∏–π —Å—Ç–∞–Ω, —â–æ —Ä–æ–±–∏—Ç—å –π–æ–≥–æ —ñ–¥–µ–∞–ª—å–Ω–∏–º –¥–ª—è —Ä–æ–∑–ø–∞—Ä–∞–ª–µ–ª—é–≤–∞–Ω–Ω—è.

–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ –æ–±—Ä–æ–±—Ü—ñ –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ **—á–∏—Å—Ç—ñ —Ñ—É–Ω–∫—Ü—ñ—ó**, —è–∫—ñ –Ω–µ –∑–º—ñ–Ω—é—é—Ç—å –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Å—Ç–∞–Ω —ñ –∑–∞–≤–∂–¥–∏ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –ó–∞–≤–¥—è–∫–∏ —Ü—å–æ–º—É —Ç–∞–∫—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –Ω–µ –∑–∞–ª–µ–∂–∞—Ç—å –æ–¥–Ω–∞ –≤—ñ–¥ –æ–¥–Ω–æ—ó —ñ –Ω–µ —Å—Ç–≤–æ—Ä—é—é—Ç—å –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø—ñ –¥–æ —Ä–µ—Å—É—Ä—Å—ñ–≤.

–û—Å–æ–±–ª–∏–≤–æ –≤–∞–∂–ª–∏–≤–∏–º–∏ –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å —î —Ç—Ä–∏ –∫–ª—é—á–æ–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è: **map**, **reduce** —Ç–∞ **filter**. –í–æ–Ω–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å —Ä–æ–∑–ø–æ–¥—ñ–ª—è—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –º—ñ–∂ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –ø—Ä–æ—Ü–µ—Å–∞–º–∏ –∞–±–æ –≤—É–∑–ª–∞–º–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥. –§—É–Ω–∫—Ü—ñ—è **map** –∑–∞—Å—Ç–æ—Å–æ–≤—É—î –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –¥–æ –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –∫–æ–ª–µ–∫—Ü—ñ—ó –Ω–µ–∑–∞–ª–µ–∂–Ω–æ, **reduce** –∞–≥—Ä–µ–≥—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, –∞ **filter** –¥–æ–∑–≤–æ–ª—è—î –≤—ñ–¥–±–∏—Ä–∞—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ. –ó–∞–≤–¥—è–∫–∏ —Ü–∏–º –æ–ø–µ—Ä–∞—Ü—ñ—è–º –º–æ–∂–Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ—Ä–≥–∞–Ω—ñ–∑—É–≤–∞—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω—É –æ–±—Ä–æ–±–∫—É, —É–Ω–∏–∫–Ω—É–≤—à–∏ —Å–∫–ª–∞–¥–Ω–æ—â—ñ–≤ –∫–ª–∞—Å–∏—á–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è.

–¶—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏ —Å—Ç–∞–ª–∏ –æ—Å–Ω–æ–≤–æ—é –¥–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó **MapReduce**, —è–∫–∞ —à–∏—Ä–æ–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É –≤–µ–ª–∏–∫–∏—Ö —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É —Ç–∞ –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö. –í–æ–Ω–∞ –¥–æ–∑–≤–æ–ª—è—î —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –≤–µ–ª–∏–∫—ñ –∑–∞–≤–¥–∞–Ω–Ω—è –Ω–∞ –ø—ñ–¥–∑–∞–¥–∞—á—ñ, —Ä–æ–∑–ø–æ–¥—ñ–ª–∏—Ç–∏ —ó—Ö –º—ñ–∂ –≤—É–∑–ª–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ —Ç–∞ –æ–±‚Äô—î–¥–Ω–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ —î–¥–∏–Ω–∏–π –ø—ñ–¥—Å—É–º–æ–∫.

–£ —Ü—ñ–π –ª–µ–∫—Ü—ñ—ó –º–∏ —Å–ø–æ—á–∞—Ç–∫—É —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è —Ç–∞ –π–æ–≥–æ –∫–ª—é—á–æ–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å, –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–π–¥–µ–º–æ –¥–æ –≥–ª–∏–±—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó MapReduce —ñ —Ä–æ–∑–±–µ—Ä–µ–º–æ —ó—ó —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–Ω–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ.

### **2. –§—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä—à–æ–≥–æ –∫–ª–∞—Å—É —É —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ–º—É –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—ñ **

–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ –∫—ñ–ª—å–∫–æ—Ö —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è—Ö, —ñ –æ–¥–Ω—ñ—î—é –∑ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö —î **—Ñ—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä—à–æ–≥–æ –∫–ª–∞—Å—É**. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ —É –ø—Ä–æ–≥—Ä–∞–º–Ω—ñ–π –º–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ç–∞–∫ —Å–∞–º–æ, —è–∫ —ñ –±—É–¥—å-—è–∫—ñ —ñ–Ω—à—ñ –∑–º—ñ–Ω–Ω—ñ. –í–æ–Ω–∏ –º–æ–∂—É—Ç—å –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏—Å—è —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –≤ —ñ–Ω—à—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, –∑–±–µ—Ä—ñ–≥–∞—Ç–∏—Å—è —É —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ö –¥–∞–Ω–∏—Ö –∞–±–æ –Ω–∞–≤—ñ—Ç—å –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏—Å—è —è–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —ñ–Ω—à–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó.

–†–æ–∑–≥–ª—è–Ω–µ–º–æ —Ü–µ–π –ø—Ä–∏–Ω—Ü–∏–ø –Ω–∞ –ø—Ä–∏–∫–ª–∞–¥—ñ Python:

```python
def square(x):
    return x * x

print(square(5))  # –í–∏–≤–µ–¥–µ: 25

# –ü—Ä–∏—Å–≤–æ—î–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –∑–º—ñ–Ω–Ω—ñ–π
f = square
print(f(5))  # –í–∏–≤–µ–¥–µ: 25

# –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ—É–Ω–∫—Ü—ñ—ó —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç
def apply_function(func, value):
    return func(value)

print(apply_function(square, 6))  # –í–∏–≤–µ–¥–µ: 36
```

–¢—É—Ç –º–∏ –±–∞—á–∏–º–æ, —â–æ —Ñ—É–Ω–∫—Ü—ñ—è `square` –º–æ–∂–µ –±—É—Ç–∏ –ø—Ä–∏—Å–≤–æ—î–Ω–∞ –∑–º—ñ–Ω–Ω—ñ–π `f` —ñ –≤–∏–∫–ª–∏–∫–∞–Ω–∞ —á–µ—Ä–µ–∑ –Ω–µ—ó. –ö—Ä—ñ–º —Ç–æ–≥–æ, –º–∏ –º–æ–∂–µ–º–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ —ó—ó —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç —É —Ñ—É–Ω–∫—Ü—ñ—é `apply_function`, —è–∫–∞ –æ—Ç—Ä–∏–º—É—î —ñ–Ω—à—É —Ñ—É–Ω–∫—Ü—ñ—é —ñ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î —ó—ó –¥–æ –∑–Ω–∞—á–µ–Ω–Ω—è.

–¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –≤—ñ–¥–∫—Ä–∏–≤–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –±—ñ–ª—å—à –≥–Ω—É—á–∫—ñ —Ç–∞ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –ø–∏—Å–∞—Ç–∏ –æ–∫—Ä–µ–º—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π, –º–∏ –º–æ–∂–µ–º–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î –ø–æ–≤–µ–¥—ñ–Ω–∫—É:

```python
def add_one(x):
    return x + 1

def multiply_by_two(x):
    return x * 2

operations = [add_one, multiply_by_two, square]

for op in operations:
    print(op(3))  # –í–∏–≤–µ–¥–µ: 4, 6, 9
```

–©–µ –æ–¥–Ω–∞ –≤–∞–∂–ª–∏–≤–∞ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å —Ñ—É–Ω–∫—Ü—ñ–π –ø–µ—Ä—à–æ–≥–æ –∫–ª–∞—Å—É ‚Äî –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—ó —è–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –¶–µ –æ—Å–æ–±–ª–∏–≤–æ –∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–∏–Ω–∞–º—ñ—á–Ω–∏—Ö –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤:

```python
def make_multiplier(n):
    def multiplier(x):
        return x * n
    return multiplier

times_three = make_multiplier(3)
print(times_three(10))  # –í–∏–≤–µ–¥–µ: 30
```

–¶–µ –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —É–∑–∞–≥–∞–ª—å–Ω–µ–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂–Ω–∞ –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –∑–∞–≤–¥–∞–Ω—å. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –∂–æ—Ä—Å—Ç–∫–æ –∑–∞–¥–∞–≤–∞—Ç–∏ –º–Ω–æ–∂–Ω–∏–∫, –º–∏ –º–æ–∂–µ–º–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –Ω–∞ –ª—å–æ—Ç—É, –ø–µ—Ä–µ–¥–∞—é—á–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏.

–§—É–Ω–∫—Ü—ñ—ó –ø–µ—Ä—à–æ–≥–æ –∫–ª–∞—Å—É —î –æ—Å–Ω–æ–≤–æ—é –¥–ª—è **–≤–∏—â–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –ø–æ—Ä—è–¥–∫—É**, —Ç–∞–∫–∏—Ö —è–∫ `map`, `reduce` —ñ `filter`. –í–æ–Ω–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –º–∞–Ω—ñ–ø—É–ª—é–≤–∞—Ç–∏ –∫–æ–ª–µ–∫—Ü—ñ—è–º–∏ –¥–∞–Ω–∏—Ö –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º, —â–æ —Ä–æ–±–∏—Ç—å –∫–æ–¥ –±—ñ–ª—å—à –∑—Ä–æ–∑—É–º—ñ–ª–∏–º —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º, –æ—Å–æ–±–ª–∏–≤–æ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å. –ù–∞—Å—Ç—É–ø–Ω–∏–º –∫—Ä–æ–∫–æ–º –º–∏ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ, —è–∫ —Ü—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–∞—Ü—é—é—Ç—å —ñ —è–∫ –≤–æ–Ω–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —É –ø—Ä–∞–∫—Ç–∏—á–Ω–∏—Ö –∑–∞–¥–∞—á–∞—Ö.

### **3. –û—Å–Ω–æ–≤–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è **

–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –ø—Ä–æ–ø–æ–Ω—É—î –Ω–∞–±—ñ—Ä —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤, —è–∫—ñ —Å–ø—Ä–æ—â—É—é—Ç—å —Ä–æ–±–æ—Ç—É –∑ –∫–æ–ª–µ–∫—Ü—ñ—è–º–∏ –¥–∞–Ω–∏—Ö —Ç–∞ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –ª–µ–≥–∫–æ –ø–∞—Ä–∞–ª–µ–ª—ñ–∑—É–≤–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è. –°–µ—Ä–µ–¥ –Ω–∏—Ö –æ—Å–æ–±–ª–∏–≤–µ –º—ñ—Å—Ü–µ –∑–∞–π–º–∞—é—Ç—å —Ç—Ä–∏ –∫–ª—é—á–æ–≤—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó: **map**, **reduce** —Ç–∞ **filter**. –¶—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —à–∏—Ä–æ–∫–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å—Å—è —É –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω–Ω—è—Ö, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –±–µ–∑ –∑–º—ñ–Ω–∏ —Å—Ç–∞–Ω—É –ø—Ä–æ–≥—Ä–∞–º–∏ —Ç–∞ –±–µ–∑ –≤–∑–∞—î–º–æ–¥—ñ—ó –º—ñ–∂ –ø–æ—Ç–æ–∫–∞–º–∏, —â–æ —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –Ω–∞ –±–∞–≥–∞—Ç–æ—è–¥–µ—Ä–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö.

#### **–§—É–Ω–∫—Ü—ñ—è map**

–§—É–Ω–∫—Ü—ñ—è `map` –≤–∏–∫–æ–Ω—É—î –æ–¥–Ω–∞–∫–æ–≤—É –æ–ø–µ—Ä–∞—Ü—ñ—é –Ω–∞–¥ –∫–æ–∂–Ω–∏–º –µ–ª–µ–º–µ–Ω—Ç–æ–º –∫–æ–ª–µ–∫—Ü—ñ—ó, –Ω–µ –∑–º—ñ–Ω—é—é—á–∏ —ó—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞–¥ –∫–æ–∂–Ω–∏–º –µ–ª–µ–º–µ–Ω—Ç–æ–º –Ω–µ–∑–∞–ª–µ–∂–Ω–æ, —â–æ —ñ–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏. –í –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–æ–∂–Ω–∞ —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –Ω–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö –Ω–∞ —á–∞—Å—Ç–∏–Ω–∏ —ñ –æ–±—Ä–æ–±–ª—è—Ç–∏ —ó—Ö –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞—Ö –∞–±–æ —Å–µ—Ä–≤–µ—Ä–∞—Ö –æ–¥–Ω–æ—á–∞—Å–Ω–æ.

–†–æ–∑–≥–ª—è–Ω–µ–º–æ –ø—Ä–æ—Å—Ç–∏–π –ø—Ä–∏–∫–ª–∞–¥: –ø—ñ–¥–Ω–µ—Å–µ–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫—É –¥–æ –∫–≤–∞–¥—Ä–∞—Ç—É.

```python
numbers = [1, 2, 3, 4, 5]

# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó map
squared_numbers = list(map(lambda x: x ** 2, numbers))

print(squared_numbers)  # –í–∏–≤–µ–¥–µ: [1, 4, 9, 16, 25]
```

–ö–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫—É –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –æ–∫—Ä–µ–º–æ, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —î –Ω–æ–≤–∏–π —Å–ø–∏—Å–æ–∫ –∑ –æ–±—á–∏—Å–ª–µ–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏. –¶–µ–π –ø—Ä–æ—Ü–µ—Å –ª–µ–≥–∫–æ —Ä–æ–∑–ø–∞—Ä–∞–ª–µ–ª—é—î—Ç—å—Å—è, –æ—Å–∫—ñ–ª—å–∫–∏ –∂–æ–¥–Ω–∞ –∑ –æ–ø–µ—Ä–∞—Ü—ñ–π –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —ñ–Ω—à–æ—ó.

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ, –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É `multiprocessing`, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –æ–±—Ä–æ–±–ª—è—Ç–∏ –¥–∞–Ω—ñ –≤ –¥–µ–∫—ñ–ª—å–∫–æ—Ö –ø—Ä–æ—Ü–µ—Å–∞—Ö:

```python
from multiprocessing import Pool

def square(x):
    return x ** 2

with Pool() as pool:
    squared_numbers = pool.map(square, numbers)

print(squared_numbers)  # –í–∏–≤–µ–¥–µ: [1, 4, 9, 16, 25]
```

–¢—É—Ç –º–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –ø—É–ª –ø—Ä–æ—Ü–µ—Å—ñ–≤ —ñ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é `square` –¥–æ –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫—É –æ–¥–Ω–æ—á–∞—Å–Ω–æ, —â–æ –∑–Ω–∞—á–Ω–æ –ø—Ä–∏—à–≤–∏–¥—à—É—î –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞ –±–∞–≥–∞—Ç–æ—è–¥–µ—Ä–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞—Ö.

#### **–§—É–Ω–∫—Ü—ñ—è reduce**

–§—É–Ω–∫—Ü—ñ—è `reduce` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ —É —î–¥–∏–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è. –í–æ–Ω–∞ —ñ–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –∑–∞–≤–¥–∞–Ω—å, –¥–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–±—á–∏—Å–ª–∏—Ç–∏ —Å—É–º—É, –¥–æ–±—É—Ç–æ–∫, –º–∞–∫—Å–∏–º—É–º –∞–±–æ —ñ–Ω—à—ñ –∞–≥—Ä–µ–≥–æ–≤–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –≤–µ–ª–∏–∫–æ–≥–æ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–∏—Ö.

–û—Å—å –ø—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `reduce` –¥–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —Å—É–º–∏ –≤—Å—ñ—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —É —Å–ø–∏—Å–∫—É:

```python
from functools import reduce

numbers = [1, 2, 3, 4, 5]

sum_of_numbers = reduce(lambda x, y: x + y, numbers)

print(sum_of_numbers)  # –í–∏–≤–µ–¥–µ: 15
```

–¶—è –æ–ø–µ—Ä–∞—Ü—ñ—è –ø–æ—Å—Ç—É–ø–æ–≤–æ –∫–æ–º–±—ñ–Ω—É—î –µ–ª–µ–º–µ–Ω—Ç–∏ —Å–ø–∏—Å–∫—É: —Å–ø–æ—á–∞—Ç–∫—É —Å–∫–ª–∞–¥–∞—î –ø–µ—Ä—à—ñ –¥–≤–∞, –ø–æ—Ç—ñ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–¥–∞—î –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ —ñ —Ç–∞–∫ –¥–∞–ª—ñ.

```python
from functools import reduce


def fibonacci(count):
sequence = (0, 1)

  

for _ in range(2, count):
sequence += (reduce(lambda a, b: a + b, sequence[-2:]), )

  

return sequence[:count]

  

print(fibonacci(12))
```

–£ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å `reduce` –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑–±–∏—Ç–∏–π –Ω–∞ –∫—ñ–ª—å–∫–∞ –µ—Ç–∞–ø—ñ–≤: —Å–ø–æ—á–∞—Ç–∫—É –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –ø—ñ–¥–º–Ω–æ–∂–∏–Ω–∞—Ö –¥–∞–Ω–∏—Ö, –∞ –ø–æ—Ç—ñ–º —á–∞—Å—Ç–∫–æ–≤—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –æ–±‚Äô—î–¥–Ω—É—é—Ç—å—Å—è –≤ —î–¥–∏–Ω–∏–π –ø—ñ–¥—Å—É–º–æ–∫. –¶–µ —î –∫–ª—é—á–æ–≤–æ—é —ñ–¥–µ—î—é —Ñ—É–Ω–∫—Ü—ñ—ó **Reduce** —É MapReduce.



#### **–§—É–Ω–∫—Ü—ñ—è filter**

–§—É–Ω–∫—Ü—ñ—è `filter` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∏–±–æ—Ä—É –µ–ª–µ–º–µ–Ω—Ç—ñ–≤, —è–∫—ñ –∑–∞–¥–æ–≤–æ–ª—å–Ω—è—é—Ç—å –ø–µ–≤–Ω—É —É–º–æ–≤—É. –¶–µ –¥—É–∂–µ –∫–æ—Ä–∏—Å–Ω–æ –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ –≤–µ–ª–∏–∫–∏–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–∏—Ö, –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ª–∏—à–µ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –ø–µ—Ä–µ–¥ —ó—Ö –ø–æ–¥–∞–ª—å—à–æ—é –æ–±—Ä–æ–±–∫–æ—é.

–†–æ–∑–≥–ª—è–Ω–µ–º–æ –ø—Ä–∏–∫–ª–∞–¥ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –ø–∞—Ä–Ω–∏—Ö —á–∏—Å–µ–ª:

```python
numbers = [1, 2, 3, 4, 5, 6, 7, 8]

even_numbers = list(filter(lambda x: x % 2 == 0, numbers))

print(even_numbers)  # –í–∏–≤–µ–¥–µ: [2, 4, 6, 8]
```

–Ø–∫ —ñ `map`, —Ñ—É–Ω–∫—Ü—ñ—è `filter` –º–æ–∂–µ –±—É—Ç–∏ —Ä–æ–∑–ø–∞—Ä–∞–ª–µ–ª–µ–Ω–∞, —è–∫—â–æ –æ–±—Ä–æ–±–∫–∞ –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —ñ–Ω—à–∏—Ö.

#### **–Ø–∫ —Ü—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–∞—Ü—é—é—Ç—å —É –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω–Ω—è—Ö?**

–§—É–Ω–∫—Ü—ñ—ó `map`, `reduce` —ñ `filter` –¥–æ–∑–≤–æ–ª—è—é—Ç—å –æ–ø–∏—Å—É–≤–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ, —Ç–æ–±—Ç–æ –≤–∏–∑–Ω–∞—á–∞—Ç–∏, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏, –∞ –Ω–µ —è–∫ —Å–∞–º–µ —Ü–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ. –ó–∞–≤–¥—è–∫–∏ —Ü—å–æ–º—É –≤–æ–Ω–∏ —ñ–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥—è—Ç—å –¥–ª—è —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É —Å–∏—Å—Ç–µ–º–∞—Ö –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö, —Ç–∞–∫–∏—Ö —è–∫ Hadoop –∞–±–æ Spark, —Ñ—É–Ω–∫—Ü—ñ—è `map` –º–æ–∂–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –¥–æ —Ä—ñ–∑–Ω–∏—Ö —á–∞—Å—Ç–∏–Ω –¥–∞–Ω–∏—Ö –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –≤—É–∑–ª–∞—Ö, `filter` –º–æ–∂–µ –ø—Ä–∏–±–∏—Ä–∞—Ç–∏ –∑–∞–π–≤—ñ –¥–∞–Ω—ñ —â–µ –Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö –µ—Ç–∞–ø–∞—Ö –æ–±—Ä–æ–±–∫–∏, –∞ `reduce` –æ–±‚Äô—î–¥–Ω—É–≤–∞—Ç–∏ —á–∞—Å—Ç–∫–æ–≤—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–±—á–∏—Å–ª–µ–Ω—å.

–£ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ –º–∏ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ, —è–∫ —Ü—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó MapReduce, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞ —Ç–∏—Å—è—á—ñ —Å–µ—Ä–≤–µ—Ä—ñ–≤ —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –≤–µ–ª–∏–∫–∏–º–∏ –æ–±—Å—è–≥–∞–º–∏ –¥–∞–Ω–∏—Ö.

–£ –±—ñ–±–ª—ñ–æ—Ç–µ—Ü—ñ `multiprocessing` –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ `map` —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ `Pool.map()`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ª–µ–≥–∫–æ —Ä–æ–∑–ø–∞—Ä–∞–ª–µ–ª–∏—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫—É. –ü—Ä–æ—Ç–µ `multiprocessing` **–Ω–µ –º–∞—î –≤–±—É–¥–æ–≤–∞–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ `filter` —Ç–∞ `reduce`**. –û–¥–Ω–∞–∫ —Ü—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –º–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –≤—Ä—É—á–Ω—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ `Pool.map()` —É –ø–æ—î–¥–Ω–∞–Ω–Ω—ñ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—é –ª–æ–≥—ñ–∫–æ—é.

### **–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π filter –∑ multiprocessing**

–û—Å–∫—ñ–ª—å–∫–∏ `filter` –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –∫–æ–ª–µ–∫—Ü—ñ—ó –Ω–µ–∑–∞–ª–µ–∂–Ω–æ, –π–æ–≥–æ –º–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ `map`, –∞ –ø–æ—Ç—ñ–º –≤–∏–¥–∞–ª–∏—Ç–∏ `None` –∞–±–æ `False` –∑–Ω–∞—á–µ–Ω–Ω—è.

```python
from multiprocessing import Pool

numbers = [1, 2, 3, 4, 5, 6, 7, 8]

def is_even(x):
    return x if x % 2 == 0 else None  # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ None –¥–ª—è –Ω–µ–ø–∞—Ä–Ω–∏—Ö —á–∏—Å–µ–ª

with Pool() as pool:
    filtered_results = pool.map(is_even, numbers)

even_numbers = [x for x in filtered_results if x is not None]

print(even_numbers)  # –í–∏–≤–µ–¥–µ: [2, 4, 6, 8]
```

–¢—É—Ç –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `map`, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫—É, –∞ –ø–æ—Ç—ñ–º –≤—Ä—É—á–Ω—É —Ñ—ñ–ª—å—Ç—Ä—É—î–º–æ –æ—Ç—Ä–∏–º–∞–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.

---

### **–ü–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π reduce –∑ multiprocessing**

–û—Å–∫—ñ–ª—å–∫–∏ `reduce` –ø–µ—Ä–µ–¥–±–∞—á–∞—î –ø–æ—Å—Ç—É–ø–æ–≤–µ –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å, –π–æ–≥–æ –º–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ `Pool.map()`, —Ä–æ–∑–±–∏–≤—à–∏ –¥–∞–Ω—ñ –Ω–∞ –±–ª–æ–∫–∏, –∞ –ø–æ—Ç—ñ–º –æ–±‚Äô—î–¥–Ω–∞–≤—à–∏ —á–∞—Å—Ç–∫–æ–≤—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏.

```python
from multiprocessing import Pool
from functools import reduce

numbers = [1, 2, 3, 4, 5, 6, 7, 8]

def chunk_sum(sublist):
    return sum(sublist)

def parallel_reduce(func, data, chunks=4):
    chunk_size = len(data) // chunks
    chunks_list = [data[i * chunk_size:(i + 1) * chunk_size] for i in range(chunks)]

    with Pool() as pool:
        partial_sums = pool.map(func, chunks_list)

    return reduce(func, partial_sums)

total_sum = parallel_reduce(sum, numbers, chunks=4)
print(total_sum)  # –í–∏–≤–µ–¥–µ: 36
```

–£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ –º–∏ —Ä–æ–∑–±–∏–≤–∞—î–º–æ –≤—Ö—ñ–¥–Ω–∏–π —Å–ø–∏—Å–æ–∫ –Ω–∞ –∫—ñ–ª—å–∫–∞ —á–∞—Å—Ç–∏–Ω, –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î–º–æ —Å—É–º—É –∫–æ–∂–Ω–æ–≥–æ –±–ª–æ–∫—É, –∞ –ø–æ—Ç—ñ–º –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `reduce` –¥–ª—è –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –æ–±‚Äô—î–¥–Ω–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤.
### **4. –í—Å—Ç—É–ø –¥–æ MapReduce**

–¢–µ–ø–µ—Ä, –∫–æ–ª–∏ –º–∏ —Ä–æ–∑—ñ–±—Ä–∞–ª–∏ –æ—Å–Ω–æ–≤–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è —Ç–∞ —è–∫ `map`, `reduce` —ñ `filter` –ø—Ä–∞—Ü—é—é—Ç—å —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å, –Ω–∞—Å—Ç–∞–≤ —á–∞—Å –ø–µ—Ä–µ–π—Ç–∏ –¥–æ **MapReduce**. –¶–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –æ–±—Ä–æ–±–ª—è—Ç–∏ –≤–µ–ª–∏–∫—ñ –æ–±—Å—è–≥–∏ –¥–∞–Ω–∏—Ö —É —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó, —è–∫—ñ –º–∏ –≤–∂–µ —Ä–æ–∑–≥–ª—è–Ω—É–ª–∏.

#### **–©–æ —Ç–∞–∫–µ MapReduce?**

MapReduce ‚Äî —Ü–µ –ø—Ä–æ–≥—Ä–∞–º–Ω–∞ –º–æ–¥–µ–ª—å –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –≤–µ–ª–∏–∫–∏—Ö –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö, —â–æ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∞ –∫–æ–º–ø–∞–Ω—ñ—î—é Google —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö. –í–æ–Ω–∞ –∑–∞—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –¥–≤–æ—Ö –æ—Å–Ω–æ–≤–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ—è—Ö:

- **Map** ‚Äî —Ä–æ–∑–±–∏—Ç—Ç—è –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –Ω–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –æ–±—Ä–æ–±–ª—è—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ.
- **Reduce** ‚Äî –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –ø—ñ—Å–ª—è –æ–±—Ä–æ–±–∫–∏.

–¶—è –º–æ–¥–µ–ª—å —î –Ω–∞–¥–∑–≤–∏—á–∞–π–Ω–æ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—é, –æ—Å–∫—ñ–ª—å–∫–∏ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞ —Ç–∏—Å—è—á–∞—Ö –≤—É–∑–ª—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ. –í–æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É –≤–µ–ª–∏–∫–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, —Ç–∞–∫–∏—Ö —è–∫ **Hadoop**, **Apache Spark** —ñ **Google BigQuery**.

#### **–Ø–∫ –ø—Ä–∞—Ü—é—î MapReduce?**

MapReduce —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –∫—ñ–ª—å–∫–æ—Ö –∫–ª—é—á–æ–≤–∏—Ö –µ—Ç–∞–ø—ñ–≤:

1. **–§–∞–∑–∞ Map**  
    –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ —Ä–æ–∑–±–∏–≤–∞—é—Ç—å—Å—è –Ω–∞ —á–∞—Å—Ç–∏–Ω–∏ (—à–º–∞—Ç–∫–∏) —Ç–∞ –æ–±—Ä–æ–±–ª—è—é—Ç—å—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –µ–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏ —Ñ—É–Ω–∫—Ü—ñ—ó `map`. –ö–æ–∂–µ–Ω –≤—É–∑–æ–ª –≤–∏–∫–æ–Ω—É—î —Å–≤–æ—é —á–∞—Å—Ç–∏–Ω—É —Ä–æ–±–æ—Ç–∏, –∞ –≤–∏—Ö—ñ–¥–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ —î –ø—Ä–æ–º—ñ–∂–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —É –≤–∏–≥–ª—è–¥—ñ –ø–∞—Ä **(–∫–ª—é—á, –∑–Ω–∞—á–µ–Ω–Ω—è)**. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –∑–∞–¥–∞—á—ñ –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —Å–ª—ñ–≤ —É —Ç–µ–∫—Å—Ç—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —Ü—å–æ–≥–æ –µ—Ç–∞–ø—É –±—É–¥—É—Ç—å –ø–∞—Ä–∏ `("—Å–ª–æ–≤–æ", 1)`, —è–∫—ñ –≤–∫–∞–∑—É—é—Ç—å, —â–æ –¥–∞–Ω–µ —Å–ª–æ–≤–æ –∑—É—Å—Ç—Ä—ñ–ª–æ—Å—è –æ–¥–∏–Ω —Ä–∞–∑.
    
2. **–§–∞–∑–∞ Shuffle (–ü–µ—Ä–µ–º—ñ—à—É–≤–∞–Ω–Ω—è)**  
    –ü—ñ—Å–ª—è —Ç–æ–≥–æ, —è–∫ —É—Å—ñ –≤—É–∑–ª–∏ –≤–∏–∫–æ–Ω–∞–ª–∏ —Å–≤–æ—é —á–∞—Å—Ç–∏–Ω—É —Ä–æ–±–æ—Ç–∏, –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–≥—Ä—É–ø—É–≤–∞—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤—ñ –∫–ª—é—á—ñ —Ä–∞–∑–æ–º. –¶–µ–π –ø—Ä–æ—Ü–µ—Å –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è "–ø–µ—Ä–µ–º—ñ—à—É–≤–∞–Ω–Ω—è–º" (`shuffle`) —ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–∏—Å—Ç–µ–º–æ—é. –£ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –≤—Å—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–ª—é—á–∞ –æ–ø–∏–Ω—è—é—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ.
    
3. **–§–∞–∑–∞ Reduce**  
    –ü—ñ—Å–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è —Ñ—É–Ω–∫—Ü—ñ—è `reduce`, —è–∫–∞ –∞–≥—Ä–µ–≥—É—î –≤—Å—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –ø–æ–≤‚Äô—è–∑–∞–Ω—ñ –∑ –æ–¥–Ω–∏–º –∫–ª—é—á–µ–º. –£ –≤–∏–ø–∞–¥–∫—É –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —Å–ª—ñ–≤ –≤–æ–Ω–∞ –ø—ñ–¥—Å—É–º–æ–≤—É—î –≤—Å—ñ –æ–¥–∏–Ω–∏—Ü—ñ, –æ—Ç—Ä–∏–º—É—é—á–∏ –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—è–≤ –∫–æ–∂–Ω–æ–≥–æ —Å–ª–æ–≤–∞.
    

#### **–ß–æ–º—É MapReduce –ø—Ä–∞—Ü—é—î –¥–æ–±—Ä–µ —É –∫–ª–∞—Å—Ç–µ—Ä–Ω–∏—Ö —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞—Ö?**

–û—Å–Ω–æ–≤–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞ —É—Å–ø—ñ—à–Ω–æ—Å—Ç—ñ MapReduce —É —Ç–æ–º—É, —â–æ –≤–æ–Ω–æ –º—ñ–Ω—ñ–º—ñ–∑—É—î –≤–∑–∞—î–º–æ–¥—ñ—é –º—ñ–∂ –≤—É–∑–ª–∞–º–∏. –û—Å–∫—ñ–ª—å–∫–∏ –µ—Ç–∞–ø `map` –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü—ñ—ó –º—ñ–∂ –ø—Ä–æ—Ü–µ—Å–∞–º–∏, –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –º–æ–∂—É—Ç—å –≤—ñ–¥–±—É–≤–∞—Ç–∏—Å—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ, —â–æ –¥–æ–∑–≤–æ–ª—è—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ —Å–∏—Å—Ç–µ–º—É. –ö—Ä—ñ–º —Ç–æ–≥–æ, —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ –∑–±–æ—ó: —è–∫—â–æ –æ–¥–∏–Ω –∑ –≤—É–∑–ª—ñ–≤ –≤–∏—Ö–æ–¥–∏—Ç—å –∑ –ª–∞–¥—É, –π–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –º–æ–∂–µ –±—É—Ç–∏ –ø–µ—Ä–µ—Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–æ –Ω–∞ —ñ–Ω—à–∏–π –≤—É–∑–æ–ª.

–†–æ–∑–≥–ª—è–Ω–µ–º–æ –∑–∞–≥–∞–ª—å–Ω—É —Å—Ö–µ–º—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è MapReduce –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ —É –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ.


### **5. –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∏–∫–ª–∞–¥—É MapReduce 

–©–æ–± –∫—Ä–∞—â–µ –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫ –ø—Ä–∞—Ü—é—î MapReduce, —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –∫–ª–∞—Å–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ **–ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É —Å–ª—ñ–≤ —É —Ç–µ–∫—Å—Ç—ñ**. –¶–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –∑–∞–¥–∞—á–∞, —è–∫–∞ —ñ–ª—é—Å—Ç—Ä—É—î –ø—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏ —Ü—ñ—î—ó –º–æ–¥–µ–ª—ñ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–∏—Ö –µ—Ç–∞–ø—ñ–≤ `Map`, `Shuffle` —ñ `Reduce`.

#### **–û–ø–∏—Å –∑–∞–¥–∞—á—ñ**

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —É –Ω–∞—Å —î —Ç–µ–∫—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª, —É —è–∫–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω—å –∫–æ–∂–Ω–æ–≥–æ —Å–ª–æ–≤–∞. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —è–∫—â–æ —Ç–µ–∫—Å—Ç –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:

```
hello world hello
```

—Ç–æ –æ—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—ñ—Å–ª—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏:

```
hello 2
world 1
```

#### **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è MapReduce —É Python –±–µ–∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫**

–î–ª—è –ø–æ—á–∞—Ç–∫—É —Ä–µ–∞–ª—ñ–∑—É—î–º–æ —Ü—é –∑–∞–¥–∞—á—É –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫, —â–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫ –ø—Ä–∞—Ü—é—é—Ç—å –æ—Å–Ω–æ–≤–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏.

##### **–ï—Ç–∞–ø 1: –§–∞–∑–∞ Map**

–ù–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ –º–∏ —Ä–æ–∑–±–∏–≤–∞—î–º–æ —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª–æ–≤–∞ —Ç–∞ —Å—Ç–≤–æ—Ä—é—î–º–æ –ø—Ä–æ–º—ñ–∂–Ω–∏–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä `(—Å–ª–æ–≤–æ, 1)`.

```python
def map_function(text):
    words = text.split()
    return [(word, 1) for word in words]

text = "hello world hello"
mapped = map_function(text)

print(mapped)
# –í–∏–≤–µ–¥–µ: [('hello', 1), ('world', 1), ('hello', 1)]
```

##### **–ï—Ç–∞–ø 2: –§–∞–∑–∞ Shuffle**

–ü—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö –ø–∞—Ä –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–≥—Ä—É–ø—É–≤–∞—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤—ñ –∫–ª—é—á—ñ —Ä–∞–∑–æ–º.

```python
from collections import defaultdict

def shuffle(mapped_data):
    grouped_data = defaultdict(list)
    for key, value in mapped_data:
        grouped_data[key].append(value)
    return grouped_data

shuffled = shuffle(mapped)
print(shuffled)
# –í–∏–≤–µ–¥–µ: {'hello': [1, 1], 'world': [1]}
```

##### **–ï—Ç–∞–ø 3: –§–∞–∑–∞ Reduce**

–ù–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ –º–∏ –æ–±—á–∏—Å–ª—é—î–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—é—á–∞.

```python
def reduce_function(shuffled_data):
    return {key: sum(values) for key, values in shuffled_data.items()}

reduced = reduce_function(shuffled)
print(reduced)
# –í–∏–≤–µ–¥–µ: {'hello': 2, 'world': 1}
```

–¶—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –¥–æ–±—Ä–µ —ñ–ª—é—Å—Ç—Ä—É—î –ø—Ä–∏–Ω—Ü–∏–ø–∏ —Ä–æ–±–æ—Ç–∏ MapReduce:

- **–§—É–Ω–∫—Ü—ñ—è `map_function`** —Ä–æ–∑–±–∏–≤–∞—î —Ç–µ–∫—Å—Ç –Ω–∞ —Å–ª–æ–≤–∞ —ñ –¥–æ–¥–∞—î `1` –¥–æ –∫–æ–∂–Ω–æ–≥–æ.
- **–§—É–Ω–∫—Ü—ñ—è `shuffle`** –≥—Ä—É–ø—É—î –æ–¥–Ω–∞–∫–æ–≤—ñ –∫–ª—é—á—ñ —Ä–∞–∑–æ–º.
- **–§—É–Ω–∫—Ü—ñ—è `reduce_function`** –ø—ñ–¥—Å—É–º–æ–≤—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–ª–æ–≤–∞.

---

#### **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è MapReduce –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º multiprocessing**

–Ø–∫—â–æ —Ç–µ–∫—Å—Ç –¥—É–∂–µ –≤–µ–ª–∏–∫–∏–π, –π–æ–≥–æ –º–æ–∂–Ω–∞ –æ–±—Ä–æ–±–ª—è—Ç–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ `multiprocessing` –¥–ª—è —Ä–æ–∑–ø–∞—Ä–∞–ª–µ–ª—é–≤–∞–Ω–Ω—è –µ—Ç–∞–ø—É `map`.

```python
from multiprocessing import Pool
from functools import reduce

text_data = [
    "hello world hello",
    "map reduce example",
    "reduce map example example"
]

def map_function(text):
    words = text.split()
    return [(word, 1) for word in words]

with Pool() as pool:
    mapped_results = pool.map(map_function, text_data)

# –û–±‚Äô—î–¥–Ω—É—î–º–æ –≤—Å—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑ —Ä—ñ–∑–Ω–∏—Ö —á–∞—Å—Ç–∏–Ω —Ç–µ–∫—Å—Ç—É
flat_mapped = [pair for sublist in mapped_results for pair in sublist]

shuffled = shuffle(flat_mapped)
reduced = reduce_function(shuffled)

print(reduced)
# –í–∏–≤–µ–¥–µ: {'hello': 2, 'world': 1, 'map': 2, 'reduce': 2, 'example': 3}
```

–£ —Ü—å–æ–º—É –∫–æ–¥—ñ:

- `Pool.map()` —Ä–æ–∑–ø–∞—Ä–∞–ª–µ–ª—é—î –æ–±—Ä–æ–±–∫—É —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ–≤.
- `flat_mapped` –æ–±‚Äô—î–¥–Ω—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤—Å—ñ—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤.
- `shuffle` —Ç–∞ `reduce_function` –≤–∏–∫–æ–Ω—É—é—Ç—å –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Å—É–º–æ–≤—É–≤–∞–Ω–Ω—è.

---


### –ü—Ä–∏–∫–ª–∞–¥ –ø—Ä–∏–º—ñ—Ç–∏–≤–Ω–æ—ó LLM
–ú–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ **–ø—Ä–∏–º—ñ—Ç–∏–≤–Ω—É –º–æ–≤–Ω—É –º–æ–¥–µ–ª—å (LLM)**, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó `map`, `reduce` —Ç–∞ `filter` —É —Å—Ç–∏–ª—ñ MapReduce. –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç ‚Äî —Ü–µ **–ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—Ç–æ—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É**.

### **–Ü–¥–µ—è –º–æ–¥–µ–ª—ñ**

1. **–í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ** ‚Äì –≤–µ–ª–∏–∫–∏–π –∫–æ—Ä–ø—É—Å —Ç–µ–∫—Å—Ç—ñ–≤.
2. **–§–∞–∑–∞ Map** ‚Äì —Ä–æ–∑–±–∏–≤–∞—î–º–æ —Ç–µ–∫—Å—Ç –Ω–∞ –±—ñ–≥—Ä–∞–º–∏ (–ø–∞—Ä–∏ —Å–ª—ñ–≤) —É –≤–∏–≥–ª—è–¥—ñ `(–ø–æ–ø–µ—Ä–µ–¥–Ω—î_—Å–ª–æ–≤–æ, –Ω–∞—Å—Ç—É–ø–Ω–µ_—Å–ª–æ–≤–æ) ‚Üí 1`.
3. **–§–∞–∑–∞ Shuffle** ‚Äì –≥—Ä—É–ø—É—î–º–æ –≤—Å—ñ –æ–¥–Ω–∞–∫–æ–≤—ñ –±—ñ–≥—Ä–∞–º–∏.
4. **–§–∞–∑–∞ Reduce** ‚Äì –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î–º–æ —á–∞—Å—Ç–æ—Ç–∏ –ø–æ—è–≤–∏ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ.
5. **–ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è** ‚Äì –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—Ç–æ—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –≤–∏–±–∏—Ä–∞—î–º–æ –Ω–∞–π—ñ–º–æ–≤—ñ—Ä–Ω—ñ—à–µ –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ª–æ–≤–æ.

---

### **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è MapReduce –¥–ª—è –ø—Ä–æ—Å—Ç–æ—ó –º–æ–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ**

–°–ø–µ—Ä—à—É –ø—ñ–¥–≥–æ—Ç—É—î–º–æ –∫–æ—Ä–ø—É—Å —Ç–µ–∫—Å—Ç—É:

```python
text_data = [
    "the quick brown fox jumps over the lazy dog",
    "the quick brown fox is fast",
    "the fox is very quick and smart"
]
```

#### **–ï—Ç–∞–ø 1: Map ‚Äì –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –±—ñ–≥—Ä–∞–º**

–†–æ–∑–±–∏–≤–∞—î–º–æ —Ç–µ–∫—Å—Ç –Ω–∞ –ø–∞—Ä–∏ —Å–ª—ñ–≤ —É –≤–∏–≥–ª—è–¥—ñ `("the", "quick")`, `("quick", "brown")` —Ç–æ—â–æ:

```python
def map_function(text):
    words = text.split()
    bigrams = [(words[i], words[i + 1]) for i in range(len(words) - 1)]
    return [(bigram, 1) for bigram in bigrams]

mapped_results = []
for line in text_data:
    mapped_results.extend(map_function(line))

print(mapped_results)
# –í–∏–≤–µ–¥–µ —Å–ø–∏—Å–æ–∫ –ø–∞—Ä: [(('the', 'quick'), 1), (('quick', 'brown'), 1), ...]
```

#### **–ï—Ç–∞–ø 2: Shuffle ‚Äì –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –±—ñ–≥—Ä–∞–º**

–ê–≥—Ä–µ–≥—É—î–º–æ –≤—Å—ñ –æ–¥–Ω–∞–∫–æ–≤—ñ –ø–∞—Ä–∏ —Ä–∞–∑–æ–º:

```python
from collections import defaultdict

def shuffle(mapped_data):
    grouped_data = defaultdict(list)
    for key, value in mapped_data:
        grouped_data[key].append(value)
    return grouped_data

shuffled = shuffle(mapped_results)
print(shuffled)
# –í–∏–≤–µ–¥–µ: {('the', 'quick'): [1, 1], ('quick', 'brown'): [1, 1], ...}
```

#### **–ï—Ç–∞–ø 3: Reduce ‚Äì –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —á–∞—Å—Ç–æ—Ç**

–ü—ñ–¥—Å—É–º–æ–≤—É—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—è–≤ –∫–æ–∂–Ω–æ—ó –±—ñ–≥—Ä–∞–º–∏:

```python
def reduce_function(shuffled_data):
    return {key: sum(values) for key, values in shuffled_data.items()}

reduced = reduce_function(shuffled)
print(reduced)
# –í–∏–≤–µ–¥–µ: {('the', 'quick'): 2, ('quick', 'brown'): 2, ('brown', 'fox'): 2, ...}
```

#### **–ï—Ç–∞–ø 4: –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞**

–°—Ç–≤–æ—Ä—é—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ü—å–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –±—É–¥–µ –ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –Ω–∞–π—ñ–º–æ–≤—ñ—Ä–Ω—ñ—à–µ —Å–ª–æ–≤–æ.

```python
def predict_next_word(word, model):
    candidates = {key[1]: count for key, count in model.items() if key[0] == word}
    if not candidates:
        return None
    return max(candidates, key=candidates.get)  # –í–∏–±–∏—Ä–∞—î–º–æ —Å–ª–æ–≤–æ –∑ –Ω–∞–π–±—ñ–ª—å—à–æ—é —á–∞—Å—Ç–æ—Ç–æ—é

print(predict_next_word("the", reduced))  # –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "quick"
print(predict_next_word("quick", reduced))  # –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "brown"
print(predict_next_word("fox", reduced))  # –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "is" –∞–±–æ "jumps"
```

---

–¶—è –º–æ–¥–µ–ª—å –ø—Ä–∞—Ü—é—î –∑–∞ –¥—É–∂–µ —Å–ø—Ä–æ—â–µ–Ω–∏–º –ø—Ä–∏–Ω—Ü–∏–ø–æ–º: –≤–æ–Ω–∞ –∞–Ω–∞–ª—ñ–∑—É—î —á–∞—Å—Ç–æ—Ç–Ω—ñ—Å—Ç—å –ø–∞—Ä —Å–ª—ñ–≤ —ñ –ø—Ä–æ–≥–Ω–æ–∑—É—î –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ª–æ–≤–æ, –≤–∏—Ö–æ–¥—è—á–∏ –∑ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö —á–∞—Å—Ç–æ—Ç. –£ —Ä–µ–∞–ª—å–Ω–∏—Ö –≤–µ–ª–∏–∫–∏—Ö LLM –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –Ω–∞–±–∞–≥–∞—Ç–æ —Å–∫–ª–∞–¥–Ω—ñ—à–∏–π –ø—ñ–¥—Ö—ñ–¥: –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **n-–≥—Ä–∞–º–Ω—ñ –º–æ–¥–µ–ª—ñ**, **word embeddings** (—è–∫ Word2Vec), **—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä–∏**, —è–∫—ñ –≤—Ä–∞—Ö–æ–≤—É—é—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞–±–∞–≥–∞—Ç–æ —à–∏—Ä—à–µ.

–ü—Ä–æ—Ç–µ —Ü–µ–π –ø—ñ–¥—Ö—ñ–¥ –Ω–∞–æ—á–Ω–æ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î, —â–æ MapReduce –º–æ–∂–Ω–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –º–æ–≤–Ω–∏—Ö –∑–∞–¥–∞—á, —ñ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è, –º–æ–∂–Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –¥—É–∂–µ –≤–µ–ª–∏–∫–∏–º–∏ –∫–æ—Ä–ø—É—Å–∞–º–∏ —Ç–µ–∫—Å—Ç—ñ–≤.

–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫ ‚Äî —è–∫—â–æ —Ö–æ—á–µ–º–æ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ —Ü–µ –Ω–∞ –≤–µ–ª–∏–∫—ñ –Ω–∞–±–æ—Ä–∏ –¥–∞–Ω–∏—Ö, –º–æ–∂–Ω–∞ –∑–∞–ø–∞—Ä–∞–ª–µ–ª–∏—Ç–∏ –æ–±—Ä–æ–±–∫—É —Ç–µ–∫—Å—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `multiprocessing`, —è–∫ –º–∏ —Ä–æ–±–∏–ª–∏ —Ä–∞–Ω—ñ—à–µ –∑ `map`.


–†–µ–∞–ª—ñ–∑—É—î–º–æ **—Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—É –æ–±—Ä–æ–±–∫—É –∫–æ—Ä–ø—É—Å—É —Ç–µ–∫—Å—Ç—ñ–≤**, —É—è–≤–∏–≤—à–∏, —â–æ —É –Ω–∞—Å —î **—á–æ—Ç–∏—Ä–∏ –∫–Ω–∏–≥–∏ —É –≤–∏–≥–ª—è–¥—ñ —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤**. –í–∏–∫–æ—Ä–∏—Å—Ç–∞—î–º–æ **multiprocessing** –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö —É –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ.

---

### **–Ü–¥–µ—è –ø—ñ–¥—Ö–æ–¥—É**

1. **–ß–∏—Ç–∞—î–º–æ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ**  
    –†–æ–∑–±–∏–≤–∞—î–º–æ –∫–æ–∂–Ω—É –∫–Ω–∏–≥—É –Ω–∞ –±—ñ–≥—Ä–∞–º–∏ (–ø–∞—Ä–∏ —Å–ª—ñ–≤).
2. **–§–∞–∑–∞ Map (–ø–∞—Ä–∞–ª–µ–ª—å–Ω–∞)**  
    –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `Pool.map()`, —â–æ–± –∫–æ–∂–µ–Ω –ø—Ä–æ—Ü–µ—Å –æ–±—Ä–æ–±–ª—è–≤ —Å–≤–æ—é —á–∞—Å—Ç–∏–Ω—É —Ç–µ–∫—Å—Ç—É.
3. **–§–∞–∑–∞ Shuffle**  
    –ì—Ä—É–ø—É—î–º–æ –±—ñ–≥—Ä–∞–º–∏, —â–æ–± –≤—Å—ñ –æ–¥–Ω–∞–∫–æ–≤—ñ –∫–ª—é—á—ñ –≤–∏—è–≤–∏–ª–∏—Å—è –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ.
4. **–§–∞–∑–∞ Reduce (–ø–∞—Ä–∞–ª–µ–ª—å–Ω–∞)**  
    –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `Pool.map()`, —â–æ–± –∫–æ–∂–µ–Ω –ø—Ä–æ—Ü–µ—Å –ø—ñ–¥—Å—É–º–æ–≤—É–≤–∞–≤ —á–∞—Å—Ç–æ—Ç–∏ –±—ñ–≥—Ä–∞–º.
5. **–ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞**  
    –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —á–∞—Å—Ç–æ—Ç–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–ª—è –≤–∏–±–æ—Ä—É –Ω–∞–π–±—ñ–ª—å—à —ñ–º–æ–≤—ñ—Ä–Ω–æ–≥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞.

---

### **–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –∫–æ—Ä–ø—É—Å—É —Ç–µ–∫—Å—Ç—ñ–≤**

#### **1. –§—É–Ω–∫—Ü—ñ—è —á–∏—Ç–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É**

–ß–∏—Ç–∞—î–º–æ –≤–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É:

```python
def read_file(filename):
    with open(filename, "r") as f:
        return f.read()
```

---

#### **2. –ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ —Ñ–∞–∑–∞ Map**

–ö–æ–∂–µ–Ω –ø—Ä–æ—Ü–µ—Å –±–µ—Ä–µ —Å–≤—ñ–π —à–º–∞—Ç–æ–∫ —Ç–µ–∫—Å—Ç—É, —Ä–æ–∑–±–∏–≤–∞—î –π–æ–≥–æ –Ω–∞ —Å–ª–æ–≤–∞ —Ç–∞ —Å—Ç–≤–æ—Ä—é—î –±—ñ–≥—Ä–∞–º–∏:

```python
def map_function(text):
    words = text.lower().split()  # –ó–º–µ–Ω—à—É—î–º–æ —Ä–µ–≥—ñ—Å—Ç—Ä —ñ —Ä–æ–∑–±–∏–≤–∞—î–º–æ –Ω–∞ —Å–ª–æ–≤–∞
    bigrams = [(words[i], words[i + 1]) for i in range(len(words) - 1)]
    return [(bigram, 1) for bigram in bigrams]
```

–û–±—Ä–æ–±–∏–º–æ –≤—Å—ñ —Ñ–∞–π–ª–∏ **–ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ**:

```python
from multiprocessing import Pool

file_list = [f"book_{i+1}.txt" for i in range(4)]  # 4 –∫–Ω–∏–≥–∏

with Pool() as pool:
    texts = pool.map(read_file, file_list)  # –ß–∏—Ç–∞—î–º–æ –≤—Å—ñ –∫–Ω–∏–≥–∏
    mapped_results = pool.map(map_function, texts)  # –ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ç–µ–∫—Å—Ç—É
```

–û–±‚Äô—î–¥–Ω—É—î–º–æ –≤—Å—ñ –±—ñ–≥—Ä–∞–º–∏ –∑ —Ä—ñ–∑–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ –≤ –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫:

```python
flat_mapped = [pair for sublist in mapped_results for pair in sublist]
```

---

#### **3. –§–∞–∑–∞ Shuffle**

–ì—Ä—É–ø—É—î–º–æ –≤—Å—ñ –±—ñ–≥—Ä–∞–º–∏ —Ä–∞–∑–æ–º:

```python
from collections import defaultdict

def shuffle(mapped_data):
    grouped_data = defaultdict(list)
    for key, value in mapped_data:
        grouped_data[key].append(value)
    return grouped_data

shuffled = shuffle(flat_mapped)
```

---

#### **4. –ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ —Ñ–∞–∑–∞ Reduce**

–¢–µ–ø–µ—Ä –∑–∞–ø—É—Å—Ç–∏–º–æ –∑–≤–µ–¥–µ–Ω–Ω—è —á–∞—Å—Ç–æ—Ç **–ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ**:

```python
def reduce_function(key_values):
    key, values = key_values
    return (key, sum(values))

with Pool() as pool:
    reduced_results = pool.map(reduce_function, shuffled.items())

# –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —Å–ø–∏—Å–æ–∫ —É —Å–ª–æ–≤–Ω–∏–∫
final_model = dict(reduced_results)
```

---

#### **5. –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞**

–°—Ç–≤–æ—Ä—é—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –ø—Ä–æ–ø–æ–Ω—É—î –Ω–∞–π–±—ñ–ª—å—à –≤–∂–∏–≤–∞–Ω–µ –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ª–æ–≤–æ:

```python
def predict_next_word(word, model):
    candidates = {key[1]: count for key, count in model.items() if key[0] == word}
    if not candidates:
        return None
    return max(candidates, key=candidates.get)  # –ù–∞–π—á–∞—Å—Ç—ñ—à–µ –≤–∂–∏–≤–∞–Ω–µ —Å–ª–æ–≤–æ

# –¢–µ—Å—Ç—É—î–º–æ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è
print(predict_next_word("the", final_model))  # –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "fox" –∞–±–æ "journey"
print(predict_next_word("knowledge", final_model))  # –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "is"
print(predict_next_word("to", final_model))  # –û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: "be"
```

---

### **–í–∏—Å–Ω–æ–≤–∫–∏**

1. –ú–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏ **–ø–∞—Ä–∞–ª–µ–ª—å–Ω—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é MapReduce** –¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ **–º–æ–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ**, —è–∫–∞ –∞–Ω–∞–ª—ñ–∑—É—î –∫–æ—Ä–ø—É—Å —Ç–µ–∫—Å—Ç—ñ–≤ —Ç–∞ –ø–µ—Ä–µ–¥–±–∞—á–∞—î –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ª–æ–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—Ç–æ—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É.
2. **Map (–ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π)** ‚Äî –∫–æ–∂–µ–Ω –ø—Ä–æ—Ü–µ—Å –æ–±—Ä–æ–±–ª—è—î —Å–≤–æ—é —á–∞—Å—Ç–∏–Ω—É —Ç–µ–∫—Å—Ç—É, —Å—Ç–≤–æ—Ä—é—é—á–∏ –±—ñ–≥—Ä–∞–º–∏.
3. **Shuffle (–≥—Ä—É–ø—É–≤–∞–Ω–Ω—è)** ‚Äî –≤—Å—ñ –æ–¥–Ω–∞–∫–æ–≤—ñ –±—ñ–≥—Ä–∞–º–∏ –æ–±‚Äô—î–¥–Ω—É—é—Ç—å—Å—è.
4. **Reduce (–ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–π)** ‚Äî —á–∞—Å—Ç–æ—Ç–∏ –±—ñ–≥—Ä–∞–º –ø—ñ–¥—Å—É–º–æ–≤—É—é—Ç—å—Å—è —É –¥–µ–∫—ñ–ª—å–∫–æ—Ö –ø—Ä–æ—Ü–µ—Å–∞—Ö.
5. **–ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è** ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –Ω–∞–π—á–∞—Å—Ç—ñ—à—É –±—ñ–≥—Ä–∞–º—É –¥–ª—è –≤–∏–±–æ—Ä—É –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞.

–¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –º–æ–∂–Ω–∞ –º–∞—Å—à—Ç–∞–±—É–≤–∞—Ç–∏ –Ω–∞ **–≤–µ–ª–∏–∫—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ –∫–æ—Ä–ø—É—Å–∏** —Ç–∞ **–∫–ª–∞—Å—Ç–µ—Ä–Ω—ñ —Å–∏—Å—Ç–µ–º–∏**, –¥–µ –æ–∫—Ä–µ–º—ñ –≤—É–∑–ª–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å `map`, –∞ –ø–æ—Ç—ñ–º –æ–±‚Äô—î–¥–Ω—É—é—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —á–µ—Ä–µ–∑ `reduce`.

—Ñ—ñ–Ω–∞–ª—å–Ω–∞ –≤–µ—Ä—Å—ñ—è –∫–æ–¥—É **–æ–¥–Ω–∏–º —Ñ–∞–π–ª–æ–º**, —è–∫–∞ —Ä–µ–∞–ª—ñ–∑—É—î **–ø–∞—Ä–∞–ª–µ–ª—å–Ω—É –æ–±—Ä–æ–±–∫—É —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤** —Ç–∞ **–ø—Ä–æ—Å—Ç—É –º–æ–≤–Ω—É –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤—ñ –±—ñ–≥—Ä–∞–º** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `multiprocessing`.

```python
import os
from multiprocessing import Pool
from collections import defaultdict

# ---------------------- 1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–µ—Å—Ç–æ–≤–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–µ–º—É–ª—è—Ü—ñ—è –∫–Ω–∏–≥) ----------------------
texts = [
    """the quick brown fox jumps over the lazy dog. the fox is fast and clever.""",
    """a journey of a thousand miles begins with a single step. the journey is long but rewarding.""",
    """to be or not to be, that is the question. the answer depends on the observer.""",
    """knowledge is power. the pursuit of knowledge shapes the mind and builds the future."""
]

file_list = [f"book_{i+1}.txt" for i in range(len(texts))]

def create_test_files():
    """–°—Ç–≤–æ—Ä—é—î —Ç–µ—Å—Ç–æ–≤—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏, —è–∫—â–æ –≤–æ–Ω–∏ —â–µ –Ω–µ —ñ—Å–Ω—É—é—Ç—å."""
    for i, text in enumerate(texts):
        if not os.path.exists(file_list[i]):
            with open(file_list[i], "w", encoding="utf-8") as f:
                f.write(text)

# ---------------------- 2. –ß–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ ----------------------
def read_file(filename):
    """–ó—á–∏—Ç—É—î –≤–º—ñ—Å—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª—É."""
    with open(filename, "r", encoding="utf-8") as f:
        return f.read().lower()  # –ü—Ä–∏–≤–æ–¥–∏–º–æ —Ç–µ–∫—Å—Ç –¥–æ –Ω–∏–∂–Ω—å–æ–≥–æ —Ä–µ–≥—ñ—Å—Ç—Ä—É

# ---------------------- 3. –§–∞–∑–∞ Map: –†–æ–∑–±–∏—Ç—Ç—è —Ç–µ–∫—Å—Ç—É –Ω–∞ –±—ñ–≥—Ä–∞–º–∏ ----------------------
def map_function(text):
    """–†–æ–∑–±–∏–≤–∞—î —Ç–µ–∫—Å—Ç –Ω–∞ –±—ñ–≥—Ä–∞–º–∏ (–ø–∞—Ä–∏ —Å–ª—ñ–≤)."""
    words = text.split()
    bigrams = [(words[i], words[i + 1]) for i in range(len(words) - 1)]
    return [(bigram, 1) for bigram in bigrams]

# ---------------------- 4. –§–∞–∑–∞ Shuffle: –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –±—ñ–≥—Ä–∞–º ----------------------
def shuffle(mapped_data):
    """–ì—Ä—É–ø—É—î –±—ñ–≥—Ä–∞–º–∏, —â–æ–± –æ–±‚Äô—î–¥–Ω–∞—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤—ñ –∫–ª—é—á—ñ."""
    grouped_data = defaultdict(list)
    for key, value in mapped_data:
        grouped_data[key].append(value)
    return grouped_data

# ---------------------- 5. –§–∞–∑–∞ Reduce: –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —á–∞—Å—Ç–æ—Ç ----------------------
def reduce_function(key_values):
    """–û–±—á–∏—Å–ª—é—î —Å—É–º—É —á–∞—Å—Ç–æ—Ç –¥–ª—è –∫–æ–∂–Ω–æ—ó –±—ñ–≥—Ä–∞–º–∏."""
    key, values = key_values
    return (key, sum(values))

# ---------------------- 6. –§—É–Ω–∫—Ü—ñ—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞ ----------------------
def predict_next_word(word, model):
    """–ü—Ä–æ–≥–Ω–æ–∑—É—î –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ª–æ–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—Ç–æ—Ç–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –±—ñ–≥—Ä–∞–º."""
    candidates = {key[1]: count for key, count in model.items() if key[0] == word}
    if not candidates:
        return None
    return max(candidates, key=candidates.get)  # –ù–∞–π–±—ñ–ª—å—à –≤–∂–∏–≤–∞–Ω–µ —Å–ª–æ–≤–æ

# ---------------------- –ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è ----------------------
if __name__ == "__main__":
    create_test_files()  # –°—Ç–≤–æ—Ä—é—î–º–æ —Ç–µ—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏, —è–∫—â–æ —ó—Ö –Ω–µ–º–∞—î

    with Pool() as pool:
        texts = pool.map(read_file, file_list)  # –ü–∞—Ä–∞–ª–µ–ª—å–Ω–µ —á–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤
        mapped_results = pool.map(map_function, texts)  # –ü–∞—Ä–∞–ª–µ–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ç–µ–∫—Å—Ç—É

    # –û–±‚Äô—î–¥–Ω—É—î–º–æ –≤—Å—ñ –±—ñ–≥—Ä–∞–º–∏ –∑ —Ä—ñ–∑–Ω–∏—Ö –ø—Ä–æ—Ü–µ—Å—ñ–≤ –≤ –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫
    flat_mapped = [pair for sublist in mapped_results for pair in sublist]

    # –§–∞–∑–∞ Shuffle: –≥—Ä—É–ø—É—î–º–æ –±—ñ–≥—Ä–∞–º–∏
    shuffled = shuffle(flat_mapped)

    # –§–∞–∑–∞ Reduce: –æ–±—á–∏—Å–ª—é—î–º–æ —á–∞—Å—Ç–æ—Ç–∏ –±—ñ–≥—Ä–∞–º –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ
    with Pool() as pool:
        reduced_results = pool.map(reduce_function, shuffled.items())

    # –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —Å–ø–∏—Å–æ–∫ —É —Å–ª–æ–≤–Ω–∏–∫
    final_model = dict(reduced_results)

    # ---------------------- CLI –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ ----------------------
    print("üìñ Simple CLI Chatbot using MapReduce")
    print("Type a word and get the most probable next word (type 'exit' to quit).")

    while True:
        user_input = input("\nEnter a word: ").strip().lower()
        if user_input == "exit":
            print("Goodbye! üëã")
            break

        prediction = predict_next_word(user_input, final_model)
        if prediction:
            print(f"ü§ñ Predicted next word: {prediction}")
        else:
            print("‚ùå No prediction available for this word.")

```


## –ü—Ä–∏–∫–ª–∞–¥ –∑ n-–≥—Ä–∞–º–∞–º–∏ —Ç–∞ –≤—ñ–∫—ñ–ø–µ–¥—ñ—î—é
```
pip install wikipedia-api
```


``` python
import os
import wikipediaapi
from multiprocessing import Pool
from collections import defaultdict
import re

# ---------------------- 1. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç–µ–π –∑ –í—ñ–∫—ñ–ø–µ–¥—ñ—ó ----------------------
wiki = wikipediaapi.Wikipedia(
    language="uk",
    user_agent="MyWikipediaBot/1.0 (contact: myemail@example.com)"
)

articles = [
    "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞",
    "–ö–æ–º–ø'—é—Ç–µ—Ä–Ω—ñ –Ω–∞—É–∫–∏",
    "–û–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–∞ —Ç–µ—Ö–Ω—ñ–∫–∞",
    "–®—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç"
]

def fetch_wikipedia_article(title):
    """–û—Ç—Ä–∏–º—É—î —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—Ç—ñ –∑ –í—ñ–∫—ñ–ø–µ–¥—ñ—ó"""
    page = wiki.page(title)
    if not page.exists():
        return ""
    text = page.text
    text = re.sub(r'\n+', ' ', text)  # –í–∏–¥–∞–ª—è—î–º–æ –∑–∞–π–≤—ñ –ø–µ—Ä–µ–Ω–æ—Å–∏ —Ä—è–¥–∫—ñ–≤
    text = re.sub(r'[^–∞-—è–ê-–Ø—ñ–Ü—ó–á—î–Ñ“ë“êa-zA-Z0-9\s]', '', text)  # –í–∏–¥–∞–ª—è—î–º–æ –∑–Ω–∞–∫–∏ –ø—É–Ω–∫—Ç—É–∞—Ü—ñ—ó
    return text.lower()

def create_corpus_from_wikipedia():
    """–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î —Å—Ç–∞—Ç—Ç—ñ —Ç–∞ —Å—Ç–≤–æ—Ä—é—î —Ç–µ–∫—Å—Ç–æ–≤–∏–π –∫–æ—Ä–ø—É—Å"""
    with Pool() as pool:
        texts = pool.map(fetch_wikipedia_article, articles)
    
    corpus_text = " ".join(texts).strip()

    if not corpus_text:
        print("‚ö†Ô∏è –ü–û–ú–ò–õ–ö–ê: –û—Ç—Ä–∏–º–∞–Ω–æ –ø–æ—Ä–æ–∂–Ω—ñ–π –∫–æ—Ä–ø—É—Å! –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Å—Ç–∞—Ç—Ç—ñ —ñ—Å–Ω—É—é—Ç—å.")
        return False

    with open("corpus.txt", "w", encoding="utf-8") as f:
        f.write(corpus_text)
    
    print(f"‚úÖ –ö–æ—Ä–ø—É—Å —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ! –î–æ–≤–∂–∏–Ω–∞: {len(corpus_text)} —Å–∏–º–≤–æ–ª—ñ–≤.")
    return True

# ---------------------- 2. –ß–∏—Ç–∞–Ω–Ω—è –∫–æ—Ä–ø—É—Å—É ----------------------
def read_corpus():
    """–ß–∏—Ç–∞—î —Ç–µ–∫—Å—Ç–æ–≤–∏–π –∫–æ—Ä–ø—É—Å"""
    if not os.path.exists("corpus.txt"):
        print("‚ö†Ô∏è –ü–û–ú–ò–õ–ö–ê: –§–∞–π–ª corpus.txt –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!")
        return ""
    
    with open("corpus.txt", "r", encoding="utf-8") as f:
        return f.read().strip()

# ---------------------- 3. –§–∞–∑–∞ Map: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è n-–≥—Ä–∞–º ----------------------
def generate_ngrams(text, n=2):
    """–ì–µ–Ω–µ—Ä—É—î n-–≥—Ä–∞–º—É (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –±—ñ–≥—Ä–∞–º–∏)"""
    words = text.split()
    if len(words) < n:
        return []
    ngrams = [tuple(words[i:i + n]) for i in range(len(words) - n + 1)]
    return [(ngram, 1) for ngram in ngrams]

def generate_ngrams_wrapper(args):
    """–û–±–≥–æ—Ä—Ç–∫–∞ –¥–ª—è multiprocessing"""
    text, n = args
    return generate_ngrams(text, n)

# ---------------------- 4. –§–∞–∑–∞ Shuffle: –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è n-–≥—Ä–∞–º ----------------------
def shuffle(mapped_data):
    """–ì—Ä—É–ø—É—î n-–≥—Ä–∞–º—É –∑–∞ –∫–ª—é—á–µ–º"""
    grouped_data = defaultdict(list)
    for key, value in mapped_data:
        grouped_data[key].append(value)
    return grouped_data

# ---------------------- 5. –§–∞–∑–∞ Reduce: –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —á–∞—Å—Ç–æ—Ç n-–≥—Ä–∞–º ----------------------
def reduce_function(key_values):
    """–û–±—á–∏—Å–ª—é—î —Å—É–º—É —á–∞—Å—Ç–æ—Ç –¥–ª—è –∫–æ–∂–Ω–æ—ó n-–≥—Ä–∞–º–∏"""
    key, values = key_values
    return (key, sum(values))

# ---------------------- 6. –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞ ----------------------
def predict_next_word(context, model, n):
    """–ü—Ä–æ–≥–Ω–æ–∑—É—î –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ª–æ–≤–æ –Ω–∞ –æ—Å–Ω–æ–≤—ñ n-–≥—Ä–∞–º"""
    words = context.split()
    if len(words) < n - 1:
        print("‚ùå –í–≤–µ–¥–µ–Ω–æ –∑–∞–Ω–∞–¥—Ç–æ –º–∞–ª–æ —Å–ª—ñ–≤ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É!")
        return None

    context_tuple = tuple(words[-(n - 1):])  # –ë–µ—Ä–µ–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ n-1 —Å–ª—ñ–≤
    candidates = {key[-1]: count for key, count in model.items() if key[:-1] == context_tuple}

    if not candidates:
        print(f"‚ùå –ù–µ–º–∞—î –ø—Ä–æ–≥–Ω–æ–∑—É –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É: {context_tuple}")
        return None

    return max(candidates, key=candidates.get)  # –ù–∞–π—ñ–º–æ–≤—ñ—Ä–Ω—ñ—à–µ —Å–ª–æ–≤–æ

# ---------------------- 7. –ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è ----------------------
if __name__ == "__main__":
    print("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç–µ–π –∑ –í—ñ–∫—ñ–ø–µ–¥—ñ—ó...")
    if not create_corpus_from_wikipedia():
        exit(1)

    print("üìñ –ß–∏—Ç–∞–Ω–Ω—è –∫–æ—Ä–ø—É—Å—É...")
    text = read_corpus()
    if not text:
        print("‚ö†Ô∏è –ü–û–ú–ò–õ–ö–ê: –ö–æ—Ä–ø—É—Å –ø–æ—Ä–æ–∂–Ω—ñ–π! –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–µ –≤–¥–∞–ª–æ—Å—è.")
        exit(1)

    n = int(input("üî¢ –í–≤–µ–¥—ñ—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è n –¥–ª—è n-–≥—Ä–∞–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 2 –¥–ª—è –±—ñ–≥—Ä–∞–º, 3 –¥–ª—è —Ç—Ä–∏–≥—Ä–∞–º): ").strip())

    print("üî® –û–±—Ä–æ–±–∫–∞ —Ç–µ–∫—Å—Ç—É...")
    with Pool() as pool:
        mapped_results = pool.map(generate_ngrams_wrapper, [(text, n)])

    flat_mapped = [pair for sublist in mapped_results for pair in sublist]

    if not flat_mapped:
        print("‚ö†Ô∏è –ü–û–ú–ò–õ–ö–ê: –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∂–æ–¥–Ω–æ—ó n-–≥—Ä–∞–º–Ω–æ—ó –ø–∞—Ä–∏. –ú–æ–∂–ª–∏–≤–æ, —Ç–µ–∫—Å—Ç –∑–∞–Ω–∞–¥—Ç–æ –∫–æ—Ä–æ—Ç–∫–∏–π?")
        exit(1)

    print("üîÑ –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è n-–≥—Ä–∞–º...")
    shuffled = shuffle(flat_mapped)

    print("üßÆ –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —á–∞—Å—Ç–æ—Ç n-–≥—Ä–∞–º...")
    with Pool() as pool:
        reduced_results = pool.map(reduce_function, shuffled.items())

    final_model = dict(reduced_results)

    if not final_model:
        print("‚ö†Ô∏è –ü–û–ú–ò–õ–ö–ê: –ú–æ–¥–µ–ª—å –ø–æ—Ä–æ–∂–Ω—è! –ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ n-–≥—Ä–∞–º–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.")
        exit(1)

    # ---------------------- CLI ----------------------
    print("\nü§ñ Simple CLI Chatbot using n-gram Model")
    print("–í–≤–µ–¥—ñ—Ç—å –∫—ñ–ª—å–∫–∞ —Å–ª—ñ–≤, —ñ –±–æ—Ç —Å–ø—Ä–æ–≥–Ω–æ–∑—É—î –Ω–∞—Å—Ç—É–ø–Ω–µ —Å–ª–æ–≤–æ (–Ω–∞–ø–∏—à—ñ—Ç—å 'exit' –¥–ª—è –≤–∏—Ö–æ–¥—É).")

    while True:
        user_input = input("\n–í–≤–µ–¥—ñ—Ç—å —Å–ª–æ–≤–∞: ").strip().lower()
        if user_input == "exit":
            print("–î–æ –ø–æ–±–∞—á–µ–Ω–Ω—è! üëã")
            break

        prediction = predict_next_word(user_input, final_model, n)
        if prediction:
            print(f"ü§ñ –ü—Ä–æ–≥–Ω–æ–∑–æ–≤–∞–Ω–µ —Å–ª–æ–≤–æ: {prediction}")
        else:
            print("‚ùå –ù–µ–º–∞—î –ø—Ä–æ–≥–Ω–æ–∑—É –¥–ª—è —Ü—å–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.")

```

